[TOC]





# 总线概述

总线：连接多个设备（或部件）进行信息传输的一组公共信号线，是各个设备共享的传输介质。  
总线事物：总线上一次设备之间的一次信息交换过程。  
主设备：发出总线事务请求的设备。  
从设备：响应总线事务请求的设备。

## 总线的分类

1.按信号线功能分类  
①数据总线：承载设备间数据内容，双向传输。  
②地址总线：指出传输的数据所在的主存单元地址或外设地址，单向传输。  
③控制总线：控制传输过程中主/从设备如何实用地址总线和数据总线，包括控制线和状态线。

2.按连接部件分类  
①片内总线：芯片内部的总线，用于连接芯片内部的元器件，只有数据线。  
②系统总线：计算机内部连接CPU、主存、外设等主要设备的总线。

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\6_1.png" alt="image-20200828151549706" style="zoom:50%;" />

③通信总线：连接计算机与外设之间、计算机之间的总线。

## 总线的特性

1.物理特性：总线在部件连接表现出来的特性。

2.功能特性：每根信号线的功能。

3.电气特性：每根信号线上的信号传递方向及信号电平有效范围。

4.时间特性（逻辑特性）：总线传输过程中每一根信号线上的信号在什么时间内有效。

## 总线的性能指标

1.总线宽度：数据总线的位数。

2.总线带宽：总线最大的数据传输率。
$$
数据传输率 = 总线宽度 \times 数据传输次数/秒
$$
3.总线负载能力：总线信号的电平保持在有效范围内时，所能连接部件或设备的数量。

## 总线的操作过程

**1.申请及分配阶段**  
需要使用总线的主设备向总线仲裁器提出请求，总线仲裁器确定那个申请者获得下一个总线传输周期的总线使用权。

**2.寻址阶段**  
总线传输周期中，获得总线使用权的主设备通过总线发出本次访问的从设备地址和操作命令，以选择及启动参与本次传输的从设备。

**3.传送数据阶段**  
主设备和从设备进行数据交换，数据由源设备发出，经数据总线流入目标设备。

**4.结束阶段**  
数据交换完成后，主设备、从设备都需要从总线上撤销自己所发出的信号，让出总线使用权。













# 总线仲裁

## 集中式仲裁

**1.链式查询方式**  
仲裁通过自动轮询各个主设备来实现，有总线请求、被询问的主设备获得总线使用权。

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\6_2.png" alt="image-20200906193742984" style="zoom:50%;" />

**2.计数器定时查询方式**  
基本思想与链式查询基本相同，轮询方式从自动轮询改为逐次、定时询问。

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\6_3.png" alt="image-20200906194850229" style="zoom:50%;" />

**3.独立请求方式**    
根据请求引脚的连接次序来进行仲裁，因而无须询问主设备，仲裁结果直接发送到主设备。

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\6_4.png" alt="image-20200906194939577" style="zoom:50%;" />

|          |            链式查询            |   计时器定时查询   |        独立请求        |
| :------: | :----------------------------: | :----------------: | :--------------------: |
| 控制线数 |               3                |                    |          2n+1          |
|   优点   | 优先级固定；结构简单；扩充容易 |     优先级灵活     | 响应速度块；优先级灵活 |
|   缺点   |  对电路故障敏感，优先级不灵活  | 控制线多；控制复杂 |   控制线多；控制复杂   |



## 分布式仲裁

**1.自举式仲裁**  
主设备用总线请求线表示优先级，各个仲裁器只连接更高优先级的总线请求线，没有接收到总线请求信号时可以获得总线使用权。

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\6_5.png" alt="image-20200906200629760" style="zoom:50%;" />

**2.竞争式仲裁**  
主设备用仲裁号表示优先级，各个仲裁器都连接仲裁总线，仲裁时从高位到低位逐位竞争，每位竞争时发送自身的该位仲裁号，并与仲裁总线上该位仲裁号进行比较，两者不等时竞争失败、退出竞争。











# 总线定式与传输

## 总线定式方式

**1.同步定时方式**  
总线事务的定时由统一的时钟信号实现，每个步骤的时长固定，以时钟周期为基准。同步总线中需配置时钟信号线，其时钟频率称为总线时钟频率。

**2.异步定时方式**  
不存在统一的时钟信号，总线事务的定时由联络信号的“握手”来实现，即每个动作都在收到请求信号后开始，功能完成后发送应答信号通知对方，每一个动作的时长是不确定的。  
(1)全互锁  
(2)半互锁  
(3)不互锁

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\6_6.png" alt="image-20200906203207136" style="zoom:50%;" />

**3.半同步定时方式**  
总线事务的定时由时钟信号、应答信号共同完成，每一个步骤的时长可变、以时钟周期为基准。半同步总线中需配置时钟信号线、应答信号线。

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\6_7.png" alt="image-20200906205222512" style="zoom:50%;" />

## 总线标准

**1.ISA总线**  

**2.PCI总线**













# 总线结构与互连

## 总线结构

**1.单总线结构**  
早期计算机都采用单总线结构，用一条系统总线连接CPU、主存及外设。【CPU通常具有总线仲裁器的功能。】

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\6_8.png" alt="image-20200906210022983" style="zoom:50%;" />

**2.多总线结构**  
(1)双总线结构  

(2)多总线结构




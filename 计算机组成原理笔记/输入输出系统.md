# I/O 系统概述

## I/O系统的组成

**1. I/O 硬件**：通常由外设、I/O接口、总线、传送控制部件组成。

**2.I/O软件**：实现信息交换的传送控制，包括**传送信息**，**主机与I/O的工作协调**。

## 外设与主机的联系

**1.外设的连接方式**：总线连接、分散连接。

**2.外设的编址方式：**统一编址方式、独立编址方式。

## I/O的传送控制方式

**1.程序直接控制方式**

**2.程序中断I/O方式**

**3.程序存储器存取方式**

**4.通道方式和I/O处理机方式**









# 外部设备

## 输入设备

**1.键盘**  
(1)非编码键盘  
(2)编码键盘 

**2.鼠标**  
(1)机械式鼠标  
(2)光电式鼠标

##  输出设备

**1.显示器**

**2.打印机**  
(1)针式打印机  
(2)激光打印机

## 存储设备

**1.磁盘**

**2.光盘**













# I/O接口

## I/O接口的功能

1.数据缓冲功能

2.操作中转功能

3.状态检测功能

4.通信控制功能

5.信号转换功能

## I/O接口的组成

主机与外设间传送的信息有**操作命令**、**数据**、**设备状态**三种，传送的方向有输入、输出两种。

**1.I/O接口组成**  
I/O接口主要由总线缓冲器、寄存器、设备选择及端口地址译码电路 、控制逻辑电路、信号转换逻辑电路等组成。 

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\7_1.png" alt="image-20200908194239664" style="zoom:50%;" />

**2.I/O接口分类**  
(1)按数据的传送方式分类：并行接口、串行接口。  
(2)按功能的选择方式分类：可编程接口和不可编程接口。  
(3)按传送的控制方式分类：程序查询方式接口、程序中断方式接口、DMA方式接口。













# 程序直接控制值 I/O方式

**1.程序查询（条件传送方式）**：CPU启动设备后，不断地查询设备的工作状态，只有在设备就绪时才进行数据传送。

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\7_2.png" alt="image-20200908201609426" style="zoom:50%;" />

**2.直接传送方式（无条件传送方式）**：数据传送前无须启动设备，设备永远处于就绪状态，随时可以进行传送，每次传送一个数据。







# 程序中断 I/O 方式

**1.控制流程**：CPU需要I/O时，执行启动外设指令后，继续执行程序处理其他事务，并不等待外设准备就绪；外设准备就绪后，向CPU提出中断请求；CPU响应中断请求，暂停执行当前程序，转去执行中断服务程序，在中断服务程序中完成数据传送任务，需要时再次启动外设，然后返回当前程序继续执行。

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\7_3.png" alt="image-20200908204322267" style="zoom:50%;" />

**2.中断分类**  
(1)可屏蔽中断：可以暂不处理。  
	不可避免中断：必须立即处理。  
(2)向量中断：通过硬件在中断响应时识别事件类型、获得处理程序入口地址。  
	非向量中断：通过软件在中断处理时识别事件类型、获得处理程序入口地址。  
(3)单重中断：在中断处理过程中不再响应新的中断请求。  
	多重中断：在中断处理过程中可以响应新的中断请求。

**3.中断的过程**：参考**操作系统**相关部分。

**4.中断判优：**  
(1)软件判优方式  
(2)串行判优方式  
(3)并行判优方式













# DMA方式

存储器直接存取（DMA方式）：由DMA接口控制外设—主存间传送数据的I/O方式，数据传送不通过CPU。  
实现DMA需要CPU在两个方面进行支持：①负责传送的准备及结果处理工作    ②数据传送时让出总线控制权

## DMA的传送方式

(1)CPU停止访问方式

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\7_4.png" alt="image-20200908213659296" style="zoom:50%;" />

(2)周期挪用方式

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\7_5.png" alt="image-20200908213951200" style="zoom:50%;" />

(3)分时交替访问方式

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\7_6.png" alt="image-20200908214210509" style="zoom:50%;" />

## DMA接口的功能与结构

(1)主存地址计数器：存放交换数据在主存中的地址，初始值为主存缓冲区的首地址。  
(2)传送计数器：存放尚未传送数据的字数（个数），初始值为需要传送的总字数。  
(3)DMA控制逻辑：控制DMA传送的过程。

<img src="C:\Users\GaoWei\Desktop\新建文件夹\图片\7_7.png" alt="image-20200908214930951" style="zoom:50%;" />

## DMA的传送过程

1.预处理：CPU完成一些必要的准备工作。

2.数据传送(DMA传送)  ：DMA的数据传输可以以单字节为基本单位，也可以以数据块为基本单位。

3.后处理：DMA控制器向CPU发送中断请求，CPU执行中断服务程序做DMA结束处理。


|                中断方式                |                   DMA方式                   |
| :------------------------------------: | :-----------------------------------------: |
|      切换程序，需要保护和恢复现场      | 只需要预处理和后处理，其他时候不需要CPU资源 |
| 中断请求响应发生在每条指令的执行周期后 |   DMA请求响应可以发生在每个机器周期结束后   |
|          传送过程需要CPU干预           |            传送过程不需要CPU干预            |
|              请求优先度低              |                请求优先度高                 |
|             靠程序传送数据             |               靠硬件传送数据                |

